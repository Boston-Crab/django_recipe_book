{% extends "base.html" %}

{% block content %}
<h2 class="black">Recipe Details for Meal ID: {{ meal_id }}</h2>

<ul class="black">
    <li>{{ meal_title }}</li>
    <li><img src="{{ meal_image }}" alt="Meal Thumbnail"></li>
    {% for item in meal_ingredients %}
        <li>{{ item }}</li>
    {% endfor %}
    <li>Region - {{ meal_culture }}</li>
    <li>Cetegory - {{ meal_category }}</li>
    <li><a href="{{ meal_source }}">Link to the meal's source</a></li>
    <li>{{ meal_instructions }}</li>
</ul>

<!-- Number of likes: -->
<p class="black">
Likes - {{ current_recipe_likes }} | Dislikes - {{ current_recipe_dislikes }}
</p>

{% if user.is_authenticated %}
    <!-- Like/Remove Like button forms: -->
    {% if is_it_liked_by_current_user %}
        <form method="post" action="{% url 'recipe_interaction:unlike_recipe' recipe_id=meal_id %}">
            {% csrf_token %}
            <button type="submit">Remove Like</button>
        </form>
    {% else %}
        <form method="post" action="{% url 'recipe_interaction:like_recipe' recipe_id=meal_id %}">
            {% csrf_token %}
            <button type="submit">Like</button>
        </form> 
    {% endif %}
    <!-- Dislike/Remove Dislike button forms: -->
    {% if is_it_disliked_by_current_user %}
        <form method="post" action="{% url 'recipe_interaction:undislike_recipe' recipe_id=meal_id %}">
            {% csrf_token %}
            <button type="submit">Remove Dislike</button>
        </form>
    {% else %}
        <form method="post" action="{% url 'recipe_interaction:dislike_recipe' recipe_id=meal_id %}">
            {% csrf_token %}
            <button type="submit">Dislike</button>
        </form> 
    {% endif %}
{% endif %}

<!-- Comment submit form -->
{% if user.is_authenticated %}
<form method="post" action="{% url 'recipe_interaction:commenting' recipe_id=meal_id %}">
    {% csrf_token %}
    <textarea rows="4" cols="50" name="comment_text" placeholder="Leave a comment"></textarea>
    <br>
    <button type="submit">Submit Comment</button>
</form>
{% endif %}

<!-- Display all comments -->
<h3 class="black">Comments</h3>
<ul>
    {% for comment in comments %}
        <p class="black"><b>By {{ comment.user.username|capfirst }} on {{ comment.comment_date|date:"F d, Y" }}</b></p>
        <p class="black">{{ comment.comment_text }}</p>
    {% empty %}
        <p class="black">No comments yet.</p>
    {% endfor %}
</ul>
{% endblock content %}